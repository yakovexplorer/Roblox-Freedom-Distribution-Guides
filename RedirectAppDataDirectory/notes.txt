# This file served as my personal notepad to keep track of what instructions I should use.  Don't consider this info as authoritative.

# "dword ptr ss:[ebp-0x458]" is not relevant, so we can use it as an intermediate buffer
# "dword ptr ss:[ebp-0x250]" is a string buffer used in SHGetFolderPathAndSubDirW branches; we redirect "subDirectory" to this address in our patches for AppData
# "dword ptr ss:[ebp+0x14]" is "const char *subDirectory"
# "0114AE80" is the address of the string "../"
# "0114BF88" is the address of the string "%s%s%s"

lea eax, ss:[ebp-0x458]
lea ebx, ss:[ebp-0x250]
xchg dword ptr ss:[ebp+0x14], ebx
mov esi, 0114AE80
push esi
xor ecx, ecx # mov ecx, 3
mov cl, 3
rep movsb
pop esi
mov cl, 3
rep movsb
mov esi, eax
mov cl, -1-6
rep movsb


push dword ptr ss:[ebp+0x14]
mov ecx, 0114AE80
push ecx
push ecx
push 0114BF88
lea eax, ss:[ebp-0x458]
push eax
call sprintf
push eax
push dword ptr ss:[esp+4]
lea eax, ss:[ebp-0x250]
push eax
mov dword ptr ss:[ebp+0x14], eax
call mbstowcs

lea eax, ss:[ebp-0x250]
mov ebx, eax
xchg dword ptr ss:[ebp+0x14], eax
push 0114AE80
push eax
call strcpy
push 0114AE80
call strstr

lea eax, ss:[ebp-0x458]
push eax
push 0x104
push eax
push 0
call dword ptr ds:[GetModuleFileNameA]
pop ebx
lea edi, dword ptr ss:[ebx+eax*2]
mov al, 5C # '\'
mov ch, 0xFF
std
mov bl, 2
repnz scasw
dec bl
jnz {TWO STATEMENTS UP}
mov byte ptr ss:[edi+2], 0


lea edi, ss:[ebp-0x244] @ 244 == 250 - C
mov eax, 0x2F002E
mov dword ptr ds:[edi-0x04], eax
ror eax, 0x10
mov dword ptr ds:[edi-0x08], eax
dec eax
mov dword ptr ds:[edi-0x0C], eax
xor ebx, ebx
mov eax, dword ptr ss:[ebp+0x14]
test eax, eax
cmovz eax, edi
movsx ecx, byte ptr ds:[eax+ebx*1]
mov word ptr ss:[edi+ebx*2], cx
inc ebx
inc ecx
loop {back 0xB bytes}

-------------

lea rdi,qword ptr ss:[rbp-60]
mov eax, 0x2F002E
push 3
pop rcx
mov dword ptr ds:[rdi],eax
mov dword ptr ds:[rdi+2],eax
add rdi,6
loop 141B65CE9

xor rbx,rbx
test r15,r15
cmove r15,rdi
movzx ecx,byte ptr ds:[r15+rbx]
mov word ptr ds:[rdi+rbx*2],cx
inc ebx
inc ecx
loop 141B65D25